<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>STM32F1_USB_bootloader: STM32F103 USB Bootloader</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32F1_USB_bootloader
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">STM32F103 USB Bootloader </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The USB bootloader is designed to upload new firmware on STM32F1 devices. It works in conjunction with <a href="http://dfu-util.sourceforge.net/">dfu-util</a> to send new programs to the microcontroller. The bootloader jumps to the main application should none of the following conditions are met.</p>
<ul>
<li>Holding Port A pin 1 high and cycle the power to the device.</li>
<li>Sending 8 null characters ( \0 ) sequentially through the USB port.</li>
<li>An occurrence of a hard fault</li>
<li>A valid program not found at the application start address (0x08003000)</li>
</ul>
<p>The bootloader checks for these conditions using the first data register in the backup domain. If this register is used for another function then the bootloader may not function as expected.</p>
<p>The majority of this bootloader is adapted from libopencm3 examples. Modifications have been made to trigger the events above.</p>
<p>The main application should be built with the <a href="www.">bootloader_project_template</a>. This template incorporates a linker script to offset the application start address as well as the USB peripheral setup.</p>
<p>Complete installation instructions can be found in the STM32F103CB globLib main directory, or by typing <b>make libdoc</b> from this directory and navigating to STM32F103CB on the top tab bar.</p>
<p>The following components are required by this template.</p>
<ul>
<li>A local copy of <a href="https://github.com/stuianna/globLib">globLib</a></li>
<li>arm-non-eabi-gcc</li>
<li>STLink-V2 (To flash the original bootloader)</li>
<li>OpenOCD</li>
<li>Doxygen (Optional for document generation)</li>
</ul>
<h2>Project Contents</h2>
<ul>
<li><b>src</b> - All source files for the project go here or in recursive directories</li>
<li><b>doc</b> - Generated Doxygen documentation, additional datasheets etc..</li>
<li><b>conf</b> - Configuration files for Doxygen</li>
<li><b>obj</b> - Generated when compiled, contains output object files</li>
<li><b>bin</b> - Generated when compiled, contains output program and map file.</li>
<li><b><a class="el" href="a00048_source.html">licence.md</a></b> - Licence file for the project</li>
<li><b><a class="el" href="a00049_source.html">readme.md</a></b> - File containing these instruction. This file can also be used as the Doxygen main-page.</li>
</ul>
<h2>Usage</h2>
<ol type="1">
<li>Clone the repository.</li>
<li>Configure the makefile so the path to GlobLib is correct.</li>
<li>Connect the MCU and STLink.</li>
<li>Run <b>make all</b> to build the program.</li>
<li>Run <b>make flash</b> to flash the program to the MCU.</li>
<li>Done.</li>
</ol>
<p>Future programs can now be flashed to the MCU with the USB peripheral and the USB bootloader template program <a href="www.google.com">link</a></p>
<h2>Make Recipes</h2>
<ul>
<li><b>make</b> - Build project.</li>
<li><b>make clean</b> - Clean object and output files.</li>
<li><b>make flash</b> - Deploy program to microcontroller with STlink.</li>
<li><b>make erase</b> - Erase the flash memory of the STM32F1 (Removes any data and program).</li>
<li><b>make libdoc</b> - View the GlobLib Doxygen documentation</li>
<li><b>make docs</b> - Compile project Doxygen documentation (Requires Doxygen)</li>
<li><b>make viewdoc</b> - View USB bootloader specific documentation</li>
<li><b>make cleandoc</b> - Remove project specific documentation</li>
</ul>
<h2>Documentation</h2>
<p>The documentation for the project can be viewed at doc/html/index.html of by running <b>make libdoc</b> from the project root directory. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Oct 16 2018 18:06:00 for STM32F1_USB_bootloader by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
